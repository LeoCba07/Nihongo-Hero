<!-- app/views/story_levels/map.html.erb -->
<div class="container fluid mt-3">
  <div class="row justify-content-center">
    <div class="col-md-4">
      <!-- Story Content Section -->
      <div class="card shadow mb-1" style="position: relative; overflow: hidden;">
        <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-image: url('<%= asset_path(@current_level.map_image) %>'); background-size: cover; background-position: center; opacity: 0.50; z-index: 0;"></div>
        <div class="card-body" style="position: relative; z-index: 1;">
          <div class="card-body text-center py-2" style="position: relative; z-index: 1;">
            <h1 class="display-5 fw-bold text-white mb-2" style="text-shadow: 0 0 15px #000, 3px 3px 0 #000;">Your Journey</h1>
            <h4 class="text-warning fw-bold mb-2" style="text-shadow: 2px 2px 13px #000;">Level <%= @accessible_level_id %></h4>
            <p class="text-white lead mb-2 px-2" style="text-shadow: 1px 1px 10px #000;"><%= @current_level&.story_content %></p>
            <% @story_levels.reverse_each do |level| %>
              <%
                is_completed = @completed_level_ids.include?(level.id)
                is_current = level.id == @accessible_level_id
                is_locked = level.id > @accessible_level_id
              %>
              <div class="gap-1 mb-3 p-2 border rounded <%= 'bg-success text-white' if is_completed %> <%= 'bg-danger text-white' if is_current %> <%= 'bg-secondary text-white' if is_locked %>">
                <% if is_completed %>
                  <p class="mb-1">âœ“ Level <%= level.id %> - Completed</p>
                <% elsif is_current %>
                  <%= button_to fights_path, method: :post, class: "btn btn-light btn-lg w-100" do %>
                    <strong>â–¶ Start Level <%= level.id %></strong>
                  <% end %>
                <% else %>
                  <p class="mb-0">ðŸ”’ Level <%= level.id %> - Locked</p>
                <% end %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
